import os
import hashlib

def calculate_md5(file_path):
    hash_md5 = hashlib.md5()
    with open(file_path, "rb") as f:
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

def scan_file(file_path, malware_signatures):
    file_hash = calculate_md5(file_path)
    if file_hash in malware_signatures:
        return True
    return False

def load_malware_signatures(file_path):
    with open(file_path, 'r') as f:
        return set(line.strip() for line in f)

def scan_directory(directory, malware_signatures):
    infected_files = []
    for root, dirs, files in os.walk(directory):
        for file in files:
            file_path = os.path.join(root, file)
            if scan_file(file_path, malware_signatures):
                infected_files.append(file_path)
    return infected_files

if __name__ == "__main__":
    signatures = load_malware_signatures('malware_signatures.txt')
    directory_to_scan = input("Enter the directory to scan: ")
    infected = scan_directory(directory_to_scan, signatures)
    
    if infected:
        print("Infected files found:")
        for file in infected:
            print(file)
    else:
        print("No infected files found.")
